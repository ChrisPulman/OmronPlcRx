<Window
    x:Class="OmronPlcRxDashboard.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:viewModels="clr-namespace:OmronPlcRxDashboard.ViewModels"
    Title="Omron PLC Dashboard"
    Width="1080"
    Height="620"
    Background="#F5F7FA"
    FontFamily="Segoe UI"
    FontSize="13"
    mc:Ignorable="d">
    <Window.Resources>
        <Style TargetType="GroupBox">
            <Setter Property="Margin" Value="0,8,0,0" />
            <Setter Property="Padding" Value="10" />
        </Style>
        <Style TargetType="TextBox">
            <Setter Property="Margin" Value="2" />
            <Setter Property="Padding" Value="4" />
        </Style>
        <Style TargetType="Button">
            <Setter Property="Margin" Value="4,0,4,0" />
            <Setter Property="Padding" Value="10,4" />
        </Style>
        <SolidColorBrush x:Key="HeaderBrush" Color="#2F4F6E" />
        <SolidColorBrush x:Key="AccentBrush" Color="#0078D4" />
        <Style TargetType="DataGrid">
            <Setter Property="RowHeaderWidth" Value="0" />
            <Setter Property="GridLinesVisibility" Value="Horizontal" />
            <Setter Property="HeadersVisibility" Value="Column" />
            <Setter Property="CanUserSortColumns" Value="True" />
        </Style>
    </Window.Resources>
    <Window.DataContext>
        <viewModels:MainWindowViewModel />
    </Window.DataContext>
    <!--  Existing layout preserved  -->
    <Grid Margin="10">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*" />
        </Grid.ColumnDefinitions>
        <!--  Connection panel  -->
        <Border
            Grid.Row="0"
            Padding="6"
            Background="White"
            BorderBrush="#D0D7E2"
            BorderThickness="1"
            CornerRadius="6">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="70" />
                    <ColumnDefinition Width="8" />
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="70" />
                    <ColumnDefinition Width="8" />
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="160" />
                    <ColumnDefinition Width="8" />
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="70" />
                    <ColumnDefinition Width="8" />
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="80" />
                    <ColumnDefinition Width="8" />
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="80" />
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                </Grid.RowDefinitions>
                <TextBlock VerticalAlignment="Center" Text="Local" />
                <TextBox Grid.Column="1" Text="{Binding Settings.LocalNodeId}" />
                <TextBlock
                    Grid.Column="3"
                    VerticalAlignment="Center"
                    Text="Remote" />
                <TextBox Grid.Column="4" Text="{Binding Settings.RemoteNodeId}" />
                <TextBlock
                    Grid.Column="6"
                    VerticalAlignment="Center"
                    Text="Host" />
                <TextBox Grid.Column="7" Text="{Binding Settings.Host}" />
                <TextBlock
                    Grid.Column="9"
                    VerticalAlignment="Center"
                    Text="Port" />
                <TextBox Grid.Column="10" Text="{Binding Settings.Port}" />
                <TextBlock
                    Grid.Column="12"
                    VerticalAlignment="Center"
                    Text="Timeout" />
                <TextBox Grid.Column="13" Text="{Binding Settings.Timeout}" />
                <TextBlock
                    Grid.Column="15"
                    VerticalAlignment="Center"
                    Text="Poll ms" />
                <TextBox Grid.Column="16" Text="{Binding Settings.PollMs}" />
                <StackPanel
                    Grid.Row="0"
                    Grid.Column="17"
                    HorizontalAlignment="Right"
                    Orientation="Horizontal">
                    <Button Command="{Binding ConnectCommand}" Content="Connect" />
                    <Button Command="{Binding DisconnectCommand}" Content="Disconnect" />
                </StackPanel>
                <TextBlock
                    Grid.Row="1"
                    Grid.ColumnSpan="18"
                    Margin="0,6,0,0"
                    Foreground="DarkSlateGray"
                    Text="{Binding Status}" />
            </Grid>
        </Border>
        <!--  Tags  -->
        <GroupBox
            Grid.Row="1"
            Padding="4"
            Background="White"
            Header="Tags">
            <DockPanel>
                <StackPanel
                    Margin="0,0,0,6"
                    DockPanel.Dock="Top"
                    Orientation="Horizontal">
                    <Button Command="{Binding AddTagCommand}" Content="Add Tag" />
                </StackPanel>
                <DataGrid
                    AlternatingRowBackground="#F1F4F8"
                    AutoGenerateColumns="False"
                    Background="White"
                    BorderThickness="0"
                    CanUserAddRows="False"
                    IsReadOnly="False"
                    ItemsSource="{Binding Tags}">
                    <DataGrid.Columns>
                        <DataGridTextColumn
                            Width="120"
                            Binding="{Binding Name}"
                            Header="Name"
                            IsReadOnly="True" />
                        <DataGridTextColumn
                            Width="120"
                            Binding="{Binding Address}"
                            Header="Address"
                            IsReadOnly="True" />
                        <DataGridTextColumn
                            Width="100"
                            Binding="{Binding ValueType.Name}"
                            Header="Type"
                            IsReadOnly="True" />
                        <DataGridTextColumn
                            Width="*"
                            Binding="{Binding Value, UpdateSourceTrigger=PropertyChanged}"
                            Header="Value" />
                        <DataGridTemplateColumn Width="70" Header="">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <Button
                                        Command="{Binding DataContext.WriteTagCommand, RelativeSource={RelativeSource AncestorType=Window}}"
                                        CommandParameter="{Binding}"
                                        Content="Write" />
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>
                    </DataGrid.Columns>
                </DataGrid>
            </DockPanel>
        </GroupBox>
        <!--  Status Bar  -->
        <StatusBar
            Grid.Row="2"
            Height="26"
            Background="#2F4F6E"
            Foreground="White">
            <StatusBarItem Content="{Binding PLCType}" />
            <StatusBarItem Content="{Binding ControllerModel}" />
            <StatusBarItem Content="{Binding ControllerVersion}" />
            <StatusBarItem Content="{Binding IsConnected, StringFormat=Connected: {0}}" />
        </StatusBar>
    </Grid>
</Window>
